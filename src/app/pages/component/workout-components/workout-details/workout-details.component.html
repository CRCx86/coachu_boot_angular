<div class="mb-20" fxLayout="row" fxLayout.lt-md="column" fxFlex fxLayoutGap="20px">
  <div fxFlex>
    <mat-card>
      <p [class]="notification.msgType" *ngIf="notification">{{notification.msgBody}}</p>
      <form *ngIf="workout" [formGroup]="workoutForm" novalidate (ngSubmit)="save()" onkeypress="if(event.keyCode == 13) return false;">
        <mat-card-header>
          <mat-card-title>
            <h2>{{workout.workoutName ? 'Edit workout': 'Add Workout'}}</h2>
          </mat-card-title>
        </mat-card-header>
        <mat-card-content>
          <div class="mb-20">
            <mat-form-field>
              <input matInput placeholder="Workout name" formControlName="workoutName" required/>
            </mat-form-field>
          </div>
          <div class="mb-20">
            <mat-form-field>
              <input matInput [matDatepicker]="picker" placeholder="Workout dateTime" formControlName="dateTime"
                     required/>
              <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
              <mat-datepicker #picker></mat-datepicker>
            </mat-form-field>
          </div>
          <div class="mb-20">
            <mat-form-field class="elements-row">
              <input matInput placeholder="Workout types" formControlName="workoutTypes" required/>
            </mat-form-field>
            <mat-form-field  class="elements-row">
              <input type="time" step="10" matInput placeholder="Time limit" formControlName="timeLimit"/>
            </mat-form-field>
          </div>
          <div class="mb-20">
            <mat-form-field>
              <input matInput type="number" placeholder="Sets" formControlName="sets" required/>
            </mat-form-field>
          </div>
          <mat-form-field>
            <input matInput #searchBox placeholder="put exercise" id="search-box" (keyup)="search(searchBox.value)"
                   [matAutocomplete]="auto" formControlName="searchExercise">
            <mat-autocomplete #auto="matAutocomplete">
              <mat-option *ngFor="let exercise of exercises$ | async" [value]="exercise.exerciseName">
                {{exercise.exerciseName}}
              </mat-option>
            </mat-autocomplete>
          </mat-form-field>
          <button mat-stroked-button type="button" (click)="addExercise(workoutForm.controls['searchExercise'].value)">
            Add new exercise
          </button>
          <mat-divider></mat-divider>
          <div formArrayName="exercises">
            <div *ngFor="let exerciseControl of workoutForm.controls['exercises'].controls; let i = index;"
                 [formGroupName]="i">
              <mat-form-field class="exercise-row">
                <input matInput placeholder="name" formControlName="exerciseName" required/>
              </mat-form-field>
              <mat-form-field class="exercise-row">
                <input matInput placeholder="repetitions" formControlName="repetitions" required/>
              </mat-form-field>
              <mat-form-field class="exercise-row">
                <input matInput placeholder="weights" formControlName="weights"/>
              </mat-form-field>
              <button [disabled]="workoutForm.controls['exercises'].controls == 1"
                      mat-stroked-button color="primary" type="button" (click)="removeExercise(i)">Remove
              </button>
            </div>
          </div>
          <mat-divider></mat-divider>
          <div *ngIf = "workout.workoutName">
            <mat-form-field class="elements-row">
              <input matInput placeholder="total reps" formControlName="totalReps" required/>
            </mat-form-field>
            <mat-form-field class="elements-row">
              <input type="time" step="10" matInput placeholder="total time" formControlName="totalTime" required/>
            </mat-form-field>
            <mat-button-toggle-group #group = "matButtonToggleGroup" [value]="workout.workoutStyle">
              <mat-button-toggle value="Rx" (change)="onChangeWorkoutStyle(group.value)">
                <mat-icon>done_all</mat-icon>
              </mat-button-toggle>
              <mat-button-toggle value="Scaled" (change)="onChangeWorkoutStyle(group.value)">
                <mat-icon>done</mat-icon>
              </mat-button-toggle>
            </mat-button-toggle-group>
          </div>
          <mat-divider></mat-divider>
          <mat-form-field class="elements-row">
            <input matInput placeholder="instructions" formControlName="instructions" required/>
          </mat-form-field>
        </mat-card-content>
        <button mat-stroked-button color="primary" type="submit" [disabled]="!workoutForm.valid">Save
        </button>
        <!--<button mat-raised-button color="secondary" (click)="remove(workout.id)"-->
        <!--*ngIf="workout.id" type="button">Delete-->
        <!--</button>-->
        <a mat-button routerLink="/workouts">Go Back </a>
      </form>
    </mat-card>
  </div>
</div>
